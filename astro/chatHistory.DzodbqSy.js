function f(){const t=localStorage.getItem("users")??"{}";let s;try{s=JSON.parse(t)}catch{s={}}return s}let e={};window.addEventListener("storage",t=>{e=f()});let a=null,n,i,h;function d(t,s){return Math.random()*(s-t)+t}async function g(t,s){if(!a)throw new Error("Invalid chat history container.");const l=await fetch(`https://www.habbo${e[t]&&e[t].hotel||""}/api/public/users?name=${e[t]&&e[t].nick||""}`).then(o=>o.json()).catch(o=>(console.error(o),{figureString:h})),r=document.createElement("div");r.classList.add("message"),r.classList.add(e[t]&&e[t].style?e[t].style:"normal"),r.innerHTML+=`
		<div class="color"></div>
      ${e[t]&&e[t].hotel?`<img class="user" src="https://www.habbo.com/habbo-imaging/avatarimage?img_format=png&direction=2&head_direction=2&size=m&headonly=1&figure=${l.figureString}" />`:""}
      <span class="nick">${t}</span><b>:</b> <span class="text">${s}</span>
  `;let c=e[t]&&e[t].offsetX&&e[t].lastMessage>Date.now()-30*60*1e3?e[t].offsetX:d(25,75);e[t]={...e[t]||{},offsetX:c,lastMessage:Date.now()},r.style.left=c+"%",a.appendChild(r),r.style.top=a.clientHeight-r.clientHeight-50+"px";for(const o of a.children)o!==r&&(o.style.top=parseInt(o.style.top)-r.clientHeight-5+"px");n&&clearInterval(n),n=setInterval(y,5*1e3),i&&clearTimeout(i),i=setTimeout(p,3*60*1e3)}function p(){clearInterval(n),i=0}function u(t){return parseInt(t.style.top)>-t.scrollHeight}function y(){if(!a)throw new Error("Invalid chat history container.");for(const t of a.children)u(t)?t.style.top=parseInt(t.style.top)-10+"px":a.removeChild(t)}function m(t,s){if(!s)throw new Error("Invalid chat history container.");return a=s,h=t.defaultLook??"hd-190-7-.ch-210-66-.lg-270-82-.sh-290-80-.ha-1015-61-61",{createChatMessage:g}}export{f as g,m as i};
